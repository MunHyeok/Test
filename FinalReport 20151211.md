#**컴퓨터 시스템 기초설계**

####**주제 :** 스마트디바이스를 이용한 아이 안전 관리 시스템
####**팀원:**  문혁, 강준영, 김현성, 임효균
####**강의 교수 / 분반** : 강승우교수님, 1분반
--------------------
--------------------

## **1.** 아이디어 개요
------
###**1.1** 개요

매년 미아 발생 및 아동 실종에 관한 사건이 언론매체에서 빠지지 않고 보도되고 있다. 특히, 2009년을 필두로 아동 실종을 사전에 방지할 수 있는 제품에 대한 수요가 증가함에 따라, 스마트 디바이스와 결합된 제품들이 꾸준히 등장하고 있다. 2015년 한국경제와 동아일보에 인체를 감지하는 센서를 횡단보도에 부착하여 미아를 방지하는 시스템에 관한 내용이 게재된 바 있다.
 
이는 아이에 대한 안전을 요구하는 부모들에게 별도의 비용을 요구하지 않았고, 학생들의 등하굣길의 안전을 책임질 수 있는 도구로써 큰 호응을 얻었다. 하지만 조기 교육의 열풍이 하나의 사회상으로 자리한 현대의 아동은 유치원, 어린이집뿐만 아니라 여러 학원을 다니는 경우가 많다. 부모의 각별한 주의 및 관심이 요구되지만, 맞벌이 부부가 증가함에 따라 이러한 관심이 현실적으로 불가능한 추세이다. 
 
 이에 따라 본 팀은 부모가 장소에 구애받지 않고 아이의 위치를 알 수 있고 안전을 확보할 수 있는 스마이트 디바이스를 이용한 아이 안전 관리 시스템을 제안하는 바이다.  

-------

###**1.2** 예상 결과물

[![](http://postfiles11.naver.net/20151211_266/dlagyrbs_1449826193773P2UpW_PNG/%C4%B8%C3%B3.PNG?type=w2)]
------
###**1.3** 선정 배경
 - 본 팀은 최근 아동 및 지적 장애인들을 대상으로 유괴 및 납치에 대한 범죄에 대한 사건이 구설수에 오르는 것에 초점을 맞추어 이를 사전에 예방할 수 있는 시스템에 대한 필요성을 느꼈다.
 
 - 미아 방지에 관한 연구가 꾸준히 진행되고 있고, 그에 따라 많은 기능이 탑재된 미아 방지를 위한 디바이스가 많이 등장하였지만 현존하는 대다수의 제품들이 디바이스의 통신 방법으로 블루투스를 채택하였다. 이러한 시스템은 아이들의 활동 반경이 나날이 넓어지고 있는 현대 사회에서 효율적으로 사용될 수 있다고 보기 어렵다. 
 
 - 7세 미만의 아동에게 휴대폰을 주는 것은 분실이나 기기 작동 미숙으로 인해 2차적인 문제가 발생할 가능성이 높다. 아이들이 물건을 잘 잃어버리고 안전에 대한 개념이 미숙한 점을 고려하여 의상에 부모와 통신이 가능한 디스플레이를 부착하여 안전 지역 이탈 및 위험 상황을 사전에 예방할 수 있는 아이디어를 고안하였다.

----------

##**2.**  문제인식
-------
###**2.1** 인식한 문제의 정의
- 부모가 아이의 신상을 원거리에서 실시간으로 감시할 수 있어야 하며 아이의 안전에 대한 부모의 걱정과 불안감을 해결해 줄 수 있는 대책이 필요하다.

---------

###**2.2** 중요성

- 미아 방지 디바이스 제품을 연구 및 생산하는 대표적인 기업 리니어블社의 문석민 대표는 “한 아이가 사라지는데 걸리는 시간은 단 35초”라고 말한 바 있다. 즉, 아이가 안전에 위협을 받고 실종이라는 상황에 처하기 전에 미리 예방할 수 있는 시간이 길지가 않다는 뜻이며 아이 실종 사고에 대한 예방이 중요하다는 것을 의미한다. 

- 공학 교육에서도 실험실을 사용하기 전 ‘실험실 안전교육’을 실시하는 것과, 실제 화재 상황에 대비하기 위해 모의 화재 상황 훈련을 실시하는 것처럼 사건이 터지기 전에 미리 주변 사람들이 위험 상황을 알 수 있고, 특히 부모와 관할 경찰서에서 이러한 사실을 알아차린다면 사고에 대한 예방이 가능할 것이다.

------
###**2.2.3** 기존의 유사 제품 분석

[![](http://postfiles1.naver.net/20151211_80/dlagyrbs_1449826194275c5nL6_PNG/%C4%B8%C3%B32.PNG?type=w2)]


**그림 1**과 **그림 2**는 각각 미아 방지를 위한 스마트 디바이스인 리니어블社의 리니어블 밴드, G&ST社의 KEEP-BO이다. 두 제품은 공통적으로 미아를 방지하기 위해 스마트 폰과 어플리케이션을 연동하는 방식을 채택하였으며, 두 기기 사이의 통신 방법으로 블루투스 기능을 탑재하였다. 하지만, 리니어블 밴드는 소모성 제품으로써 사용기한이 1년이며, 이탈 감지 거리가 짧다는 단점이 있으며 아이의 위치를 어플리케이션을 통해 확인할 때 오차와 시간 차이가 크다.

 KEEP-BO 또한 블루투스의 특성 사 거리 조건의 제약을 받으며 이탈 감지 시간까지 **20초**의 시간이 걸린다. 본 팀이 제안하는 주변 사람들에게 아이의 위험 신호를 알려주는 일종의 클라우드 개념이 기존의 기기들에는 탑재되지 않았으므로 단연 효율적인 면에서 떨어진다.

-----
##**3.** 문제정의

-----
###**3.1** 문제의 근본원인 분석
 - 기존의 미아 방지를 위한 스마이트 디바이스들은 데이터 송수신 거리가 짧으며 그에 대한 시간이 길     기 때문에 아이의 안전 확보에 제한이 있다.
 
 - 아이가 위험 상황에 처했을 때, 주변 사람들이 그 상황을 인지할 수 있는 신호가 전송될 수 있는 일종     의 클라우드 형성이 이루어지지 않고 있다.

-----

###**3.1.1** 분석방법

**문제** : 부모가 **장소에 구애받지 않고** 아이의 **위치를 알 수 있고안전을 확보**할 수 있는 스마이트 디바이스를 개발해야 한다.

**(1) 왜 부모가 스마이트 디바이스를 통해 아이의 위치를 알아야 하고 안전을 확보해야 하나?**

- 맞벌이 가정이 증가하는 추세이고 현실적으로 아이가 유치원 및 학원을 이동할 때 부모가 항상 보살펴 줄 수 없는 것이 사실이므로.

**(2) 왜 아이를 항상 보살펴 주어야 하나? **

- 현재 아동에 관한 범죄의 비율을 보면 7세 미만의 아동을 대상으로 행해지는 범죄가 가장 많고, 조기 교육의 열기가 나날이 뜨거워지는 추세이므로 아이의 활동 범위가 넓어졌기 때문이다.

**(3) 왜 아이의 활동 범위가 넓어지는가?**
 
 - 유치원, 학교뿐만 아니라 피아노, 태권도, 영어 등 아이에게 다양한 방면의 교육을 시키려는 부모의 교육열 때문에 그 만큼 아이의 활동 범위가 증가한다. 

**(4) 왜 부모는 아이에게 다양한 방면의 교육을 시키려고 하나?** 
 
 - 다양한 방면의 교육을 통해 아이의 창의력이나 동급생들에 비해 뛰어난 실력을 소유할 수 있고, 이로 인해 좋은 성적을 받을 수 있기 때문이다.

**(5) 왜 아이가 동급생에 비해 뛰어난 실력을 소유해야 하는가? **

- 흔히 사회에서 보편적으로 일컬어지는 ‘성공한 사람’이 되기 위한 조건으로 초등학교부터 대학까지의 교육 커리큘럼을 이수하는 것이 중요하다고 여겨지기 때문에 좋은 성적을 받는 것이 중요하다. 

------------------
**최종 결론** : 맞벌이 부부 가정이 증가하고, 아이에 대한 교육열로 인해 아이의 활동 반경이 넓어지는 문제가 불가피하므로 부모가 아이의 안전을 확보, 검토 할 수 있는 해결책이 필요하다.  

-------

###**3.2** 진짜 문제 정의

**최초의 문제 정의 : 부모가 아이의 안전에 대한 상황을 쉽고 빠르게 인지할 수 				    없을까?**

- 사용에 대한 어려움이 없게 아이의 위치와 상황을 상시 확인할 수 있도록 개발되어야 한다.

- 사용자가 거리에 대한 제한을 받지 않도록 설계되어야 한다.

- 아이가 위험 상황에 처했을 때, 주변 사람들이 그 상황을 알 수 있도록 어떠한 표시를 할 수 있어야 한다.

- 부모가 주변 사람의 도움을 직접적으로 구하기 어려운 상황을 대비해 메시지 전송을 통해 아이의 옷에 장착되어 있는 LED에 그 메시지를 띄워줄 수 있어야 한다.

- 아이가 선택적으로 부모에게 위험 신호를 알리는 기능이 구현되어야 한다.

------

###**3.3** 제품 제작 시 고려되어야 할 제한 사항
- 본 팀이 제안하는 시스템에서 중요하게 고려하여야 하는 제한조건은 다음과 같다.

- 아이의 옷에 부착될 LED는 부모가 보내는 메시지를 수신하여 주변 사람들이 볼 수 있도록 그 내용을 표현할 수 있어야 하기 때문에 대용량 배터리가 장착되어야 하며 아이가 이러한 장치로 인해 불편함을 느끼지 않도록 설계해야 한다.

- 본 시스템에서 사용될 GPS는 아이에 대한 위치를 수신하여 부모가 사용하는 컴퓨터 또는 스마트 폰으로 전송할 수 있도록 설계해야 한다. GPS에 대한 오차가 항상 존재하는 점을 고려하여 오차 값을 포함한 범위를 부모에게 표현할 수 있어야 한다. 

- 또한, 기존의 장치들에 비해 빠르고 데이터 송수신 거리를 넓히기 위해 고속 와이브로 또는 지그비가 탑재되어야 한다. 이러한 기기들은 마이크로프로세서를 통해 제어될 예정이므로 물에 취약하다. 때문에, 방수 처리를 하여 아이의 옷에 부착되어야 한다. 

-  이 때, 부모뿐만 아니라 SNS 혹은 자체적으로 개발할 예정인 미아 방지 어플리케이션을 설치해놓은 다른 사용자 또는 가까운 경찰서에서, 아이에 대한 상황을 체크하여 1차적인 문제를 해결할 수 있도록 알림을 보내주어야 한다. 

-----

##**4.** 아이디어 도출

----

###**4.1** 최적해**(Best Solution)**
- 아이의 안전을 위해 거리에 제한받지 않고 간단한 조작을 통해 부모가 보살펴 줄 수 있는 스마트 기기를 개발하여 언제 발생할지 모르는 미아에 대한 사전 예방을 확실하게 하자.

----
###**4.2** 시스템 설계
-----

###**4.2.1** 핵심 콤포넌트 상세 설계도

- 본 시스템은 아래와 같이 웨어러블 디바이스(아이), 서버 시스템, 어플리케이션(부모)으로 구성되었다.

------

####**4.2.1.1** 웨어러블 디바이스

[![](http://postfiles12.naver.net/20151211_219/dlagyrbs_1449826190169mOBkM_PNG/noname01.png?type=w2)]

**<그림 3. 웨어러블 디바이스 설계도>**

- 아이의 옷에 부착될 웨어러블 디바이스는 상황 인지 시스템, 디스플레이, 데이터 송수신 장치로 구성되어있다. 먼저, 상황 인지 시스템은 아두이노를 기반으로 하여 GPS 데이터를 수신하여 보호자가 아이의 위치를 확인할 수 있다. 또한 아이가 옷에 부착된 스위치를 선택적으로 사용함으로써 자신의 상황을 부모에게 전송할 수 있다. 

- 부모가 보내는 메시지와 신호를 수신하게 되면 옷에 장착되어 있는 플렉서블 LED의 전원이 켜지고 LED가 켜지며 메시지가 뜬다. 이러한 데이터 송수신은 3G 모듈을 통해 이루어진다.

-----
####**4.2.1.2** 서버 시스템

[![](http://postfiles2.naver.net/20151211_1/dlagyrbs_1449826190537DrKN0_PNG/noname02.png?type=w2)]

**<그림 4. 서버 시스템 설계도>**


- **그림 4**는 본 시스템의 서버 시스템 설계도이다. 서버 시스템에서는 클라우드 플랫폼을 형성하여 아이가 스스로 위험 상황을 부모에게 전송하는 스위치 버튼이 작동하거나 부모가 아이가 위험하다고 판단되어 메시지를 보낼 경우 주변 사람들에게 이를 알려줄 수 있다. 

- 어플리케이션 설치를 통해 주변 사람들은 클라우드 플랫폼에 참여하게 되고, 위험 신호를 수신한 기기의 로그를 통해 위험 상황을 인지한 사람들 중 아이와 가장 가까운 사람의 위치를 파악할 수 있다. 

----
####**4.2.1.3** 어플리케이션


[![](http://postfiles7.naver.net/20151211_102/dlagyrbs_1449826191008QsAgg_PNG/noname33.png?type=w2)]

**<그림 5. 어플리케이션 구성도>**

- **그림 5**는 본 시스템의 어플리케이션 기능 구성도이다. 부모 또는 사용을 원하는 사용자는 자신의 스마트 기기에 어플리케이션을 설치하여 다음과 같은 기능을 사용할 수 있다. 

- 위치정보 버튼을 통해 GPS를 통해 아이의 위치를 실시간으로 확인할 수 있고, 문자 전송 버튼을 통한 메시지 전송, 주요 메시지를 미리 입력해놓거나 아이의 위치 반경 설정을 할 수 있는 설정 버튼이 있다. 또한 본 어플리케이션을 설치해놓은 사용자에 한해서 가까운 곳에서 발생한 미아 사건을 접수하여 빠르게 도움을 줄 수 있다.

###**4.2.2**시스템 흐름도

[![](http://postfiles12.naver.net/20151211_155/dlagyrbs_1449826190668WL2Te_PNG/noname5.png?type=w2)]

**<그림 6. 스마트 디바이스를 이용한 아이 안전 관리 시스템 흐름도>**


- 본 시스템의 시스템 흐름도는 **그림 6**과 같다.

-  아이의 옷에 부착되어 있는 안전 관리 시스템에는 위치 추적용 GPS가 장착되어 있다. 아이가 현재 위치하고 있는 곳의 좌표는 아두이노 모듈에 연결된 3G 데이터 망을 통해 부모에게 전송이 된다. 이를 통해 부모는 아이가 어떤 장소에 있는지 실시간으로 확인할 수 있다.

-  아이의 옷에 부착된 안전 관리 시스템은 플렉시블 LED와 스위치로 구성되어 있으며, 이는 대용량 리튬 폴리머 배터리를 통해 지속적으로 사용이 가능하다.

-  스위치는 아이가 자신의 상황을 부모에게 알리고 싶을 경우 선택적으로 누를 수 있으며, 이러한 신호는 데이터 망을 통해 부모에게 전달된다. 

- 만약 아이가 인지하지 못하는 상황에서 부모가 자신의 아이가 위험에 처했다고 판단했을 경우, 어플리케이션을 사용하고 있는 사용자 중, 아이가 위치한 곳에서 가장 가까운 사람이나 경찰서에 도움을 요청할 수 있는 알림을 보낼 수 있게 된다.

-----
##**5.** 시스템 구현에 필요한 기술 및 개발 환경


----

###**5.1** 시스템 구현에 필요한 기술

[![](http://postfiles2.naver.net/20151211_33/dlagyrbs_1449826193302x6oJz_PNG/%C4%B811%C3%B3.PNG?type=w2)]

----
**기본적인 위치 추적 구현 기술**

[![](http://postfiles9.naver.net/20151211_24/dlagyrbs_14498261947604IBJx_PNG/%C4%B8%C3%B311.PNG?type=w2)]


- GPS 모듈의 GND, Vcc선을 아두이노 GND, 5V핀에 연결한다. GPS의 RX, TX선을 각각 아두이노의 2, 3번 핀에 연결한다. 이어서 스케치를 아두이노에 업로드한다

- $GPRMC, 030136, 000, A, 3729.9446, N, 12701.4042, E, 0.00, , 140315, , ,A*71

- GPS데이터는 시간, 위치, 방위 등의 정보를 전송하기 위한 규격인 NMEA (미국 National Marine Electronics Association에서 정의)신호 체계로 표기되며 다음과 같이  출력된다

- TinyGPS 라이브러리를 활용하여 NMEA메세지를 독해 가능한 포맷으로 변환하여 구글맵에 기록해준다
 
[![](http://postfiles8.naver.net/20151211_135/dlagyrbs_1449826192999i6aqA_PNG/%A4%B8%A4%B8%A4%B8%A4%B8.png?type=w2)]


**실내에 있어 GPS 값을 제대로 받아오지 못할 때 위치 추적 알고리즘**

**[목적]**
GPS와 Wi-Fi를 이용하지 않고 가속도 센서와 자이로 센서를 이용하여 움직임을 수학적으로 연산하여 분석하는 접근 방식으로 실내 위치 인식하여 미아가 실내에 있을 경우 보다 정확한 위치 찾기 

**[개략]**


[![](http://postfiles16.naver.net/20151211_111/dlagyrbs_1449826189905rWPYU_PNG/awdawd.png?type=w2)]

- 건물의 입구와 같이 현재 위치를 알 수 있는 마지막 지점에서 마지막의 위치를 체크 한다.

- 마지막 체크된 위치부터 들어오는 가속도 센서의 데이터 값, 자이로센서 값을 통한 이동거리 및 
  방향을 연산한다.

- 마지막 체크된 위치와 연산한 값을 통해 실내에서의 현재 위치를 파악한다.

[![](http://postfiles10.naver.net/20151211_281/dlagyrbs_1449826190360bQsNf_PNG/noname01%A4%B8%A4%B8.png?type=w2)]

**가속도 ? 거리 관계**



- 가속도 거리를 적분하면 속도, 속도를 적분하면 거리
- 이를 이용하여 마지막 GPS측정위치와 함께 연산하여 실내의 위치 측정

[![](http://postfiles11.naver.net/20151211_218/dlagyrbs_1449826189389pc7xB_PNG/1111.%A4%C4%A4%CC%A4%BE.png?type=w2)]

**Trapezoidal Method**

- 적분할 때 이론상으로는 완벽한 값이 나오지만, 현실에서는 sampling 한계로 양자화 과정 중 Area error 발생
- 따라서 오차가 적은 Trapezoidal Method 이용


[![](http://postfiles10.naver.net/20151211_297/dlagyrbs_14498261922818CqMP_PNG/%A4%B1%A4%B8%A4%B7%A4%B11.png?type=w2)]

**교정**

- 센서의 기울기와 그에 따른 중력에 의해 영향을 받으므로 교정이 필요하다
- 정지한 상태에서의 가속도 값을 알아내어 중력 가속도 값으로 인지 하고 제거해준다


[![](http://postfiles13.naver.net/20151211_204/dlagyrbs_14498261915592on16_PNG/%B1%D7%B8%B222221.png?type=w2)]
**위치값 표시**

- 가속도 센서데이터(acceleration data)를 이중적분 하여 현재 위치값을 구한다.

- 첫번째 적분 => velocityX[1] = velocitX[0] + accelerationX[0]+((accelerationX[1]-accelerationX[0]) /2)

- 두번 적분 => PositionX[1] = positionX[0] + velocityX[0] + ((velocityX[1] -velocityX[0]) / 2)

- => 최종 위치값 Position을 얻어 낸다.

----

###**5.2** 제품 개발을 위해 필요한 재료, 장비, 도구

[![](http://postfiles6.naver.net/20151211_245/dlagyrbs_1449826189538xgUfl_PNG/awda1wd.png?type=w2)]


----

###**5.2.1**데이터 전송부

[![](http://postfiles2.naver.net/20151211_193/dlagyrbs_1449826192477utr3d_PNG/%A4%B7%A4%B7%A4%B7%A4%B7%A4%B8.png?type=w2)]


**<소형 3G모듈 및 부모의 단말기 예시>**

- 요즘에 나오는 3G모뎀의 경우 그 사이즈가 동전 크기와 비슷하다. 이를 이용하여 다양한 웨어러블 장비에 3G모듈을 장착할 수 있으며 핸드폰과 같이 장거리 통신이 가능해진다. 3G/GSM 회선을 이용해 데이터와 음성 통신이 가능하며 최대속도는 상향 5.76Mb/sec, 하향 7.2Mb/sec로 간단한 데이터를 보내기에 충분한 속도가 제공된다.

- 개발방법
1. 아이의 단말기 -> 부모의 단말기 : 3G모뎀을 이용하여 부모의 단말기와 통신이 가능하도록 만들며 위험에 처한 상황이 발생하여 아이가 긴급 스위치를 누르면 옷에 부착된 소형컴퓨터(ex 아두이노)를 이용하여 자신의 현재 위치와 상황을 캡슐화하여 서버와 부모의 단말기에 동시에 뿌려주는 역할을 수행하게 한다. 

2. 부모의 단말기 -> 아이의 단말기 : 부모는 아이의 현재위치를 실시간으로 볼 수 있으며 자신이 예상치 못한 위치일 경우 부모의 단말기에서 아이의 단말기로 3G통신망을 이용해 옷에 나타나게 될 간단한 문자와 긴급스위치를 발동시킬 데이터를 캡슐화하여 서버와 아이에게 동시에 뿌린다.

----

###**5.2.2** 데이터 수신부

- 개발방법
1. 아이의 단말기 : 3G망을 통해 넘어온 데이터를 소형 컴퓨터를 이용해 받게 되면 캡슐화된 정보를 역캡슐화하여 확인한 후 옷에 부착된 LED판에 즉각적으로 데이터가 적용되도록 구현한다.

2. 부모의 단말기: 아이에게서 온 데이터를 단말기(핸드폰)에서 해독한 후 긴급한 상태일 경우에 진동과 푸시알림 벨소리를 울리게 한다.